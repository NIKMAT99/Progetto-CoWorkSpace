<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Test Upload</title>
</head>
<body>
<h2>Test Upload Immagine</h2>

<input type="file" id="test-image" name="cover_image_url" accept="image/*">
<button id="upload-btn">Carica Immagine</button>

<div id="result"></div>

<script>
  document.getElementById("upload-btn").addEventListener("click", async () => {
    const fileInput = document.getElementById("test-image");

    console.log("DEBUG input:", fileInput, fileInput.files);

    if (!fileInput.files || fileInput.files.length === 0) {
      alert("Nessun file selezionato!");
      return;
    }

    const fd = new FormData();
    fd.append("cover_image_url", fileInput.files[0]);

    try {
      const token = localStorage.getItem("jwt_token"); // se serve autenticazione
      const res = await fetch("http://localhost:3000/upload", {
        method: "POST",
        headers: token ? { "Authorization": `Bearer ${token}` } : {},
        body: fd
      });

      const data = await res.json();
      console.log("Risposta backend:", data);
      document.getElementById("result").innerText = JSON.stringify(data, null, 2);
    } catch (err) {
      console.error("Errore upload:", err);
    }
  });
</script>
</body>
</html>
